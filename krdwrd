#!/bin/bash

CONFIG=$(dirname $0)/config.app
if [ ! -f ${CONFIG} ]; then
    echo $(basename $0): Adapt FILE:config.dist and save it as $(basename ${CONFIG}) 
    exit 1
else
    . ${CONFIG}
fi

if [[ ${KW_XVFB} == "true" ]]
then
    if [[ ! $(pgrep -f "Xvfb :${KW_DISPLAY} -screen ${KW_SCREEN}") ]]; then
        Xvfb :${KW_DISPLAY} -screen ${KW_SCREEN} 1024x768x24 > /dev/null 2>&1 & 
        echo $(basename $0): Started Xvfb, DISPLAY is :${KW_DISPLAY}.${KW_SCREEN} 
    fi
    DISPLAY=:${KW_DISPLAY}.${KW_SCREEN} ${XULRUNNER} $APP/application.ini $@
else
    ${XULRUNNER} $APP/application.ini $@
fi
